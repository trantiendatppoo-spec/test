-- [[ EMMA HUB V35 - BẢN FIX UI & LOGIC CHUẨN ]] --
-- [[ KEY: emmawatson ]] --

-- 1. NẠP THƯ VIỆN UI GIỐNG ẢNH
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/WhiteX1208/NightUI/refs/heads/main/Source.lua"))()

-- 2. ĐÈ THÔNG TIN ĐỂ DẸP NIGHTX
local Window = Library:NewWindow({
    Title = "Emma Hub [PRO VERSION]",
    Description = "Tác giả: Emma Hub Team", -- Thay đổi mô tả ở đây
    Scale = game:GetService("UserInputService").TouchEnabled and UDim2.fromOffset(480, 360) or UDim2.fromOffset(580, 430),
})

-- BIẾN ĐIỀU KHIỂN
_G.AutoFarm = false
_G.SelectWeapon = "Melee"

-- 3. CÁC TAB CHỨC NĂNG
local Tab1 = Window:AddTab({ Title = "Main Farm", Icon = "84348960772548" })

Tab1:AddDropdown({
    Title = "Chọn Vũ Khí Để Farm",
    Values = {"Melee", "Sword", "Fruit"},
    Default = "Melee",
    Callback = function(v) _G.SelectWeapon = v end
})

Tab1:AddToggle({
    Title = "Bật Auto Farm Level (Nhận Quest)",
    Default = false,
    Callback = function(v) _G.AutoFarm = v end
})

-- 4. SIÊU LÕI FARM (DÀNH CHO LEVEL 2800)
task.spawn(function()
    while task.wait() do
        pcall(function()
            if _G.AutoFarm then
                local char = game.Players.LocalPlayer.Character
                local root = char.HumanoidRootPart
                
                -- TỰ BẬT HAKI
                if not char:FindFirstChild("HasBuso") then
                    game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("Buso")
                end

                -- TÌM QUÁI VÀ TELEPORT (THOÁT KHỎI CAFÉ)
                for _, mob in ipairs(workspace.Enemies:GetChildren()) do
                    if mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                        -- Bay sát quái
                        root.CFrame = mob.HumanoidRootPart.CFrame * CFrame.new(0, 12, 0)
                        
                        -- CẦM VŨ KHÍ (FIX NHẢY ĐỒ)
                        local tool = game.Players.LocalPlayer.Backpack:FindFirstChild(_G.SelectWeapon) or char:FindFirstChild(_G.SelectWeapon)
                        if tool and not char:FindFirstChild(tool.Name) then
                            char.Humanoid:EquipTool(tool)
                        end
                        
                        -- SIÊU AURA V15 (VẢ CỰC RÁT)
                        local net = game:GetService("ReplicatedStorage").Modules.Net
                        net["RE/RegisterAttack"]:FireServer()
                        net["RE/RegisterHit"]:FireServer(mob.HumanoidRootPart, {{mob, mob.HumanoidRootPart}}, nil, nil, "EmmaV35")
                        break
                    end
                end
            end
        end)
    end
end)
